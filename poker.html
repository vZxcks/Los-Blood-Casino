<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Poker - Los Blood Casino</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
.card { background:white; color:black; padding:10px; border-radius:8px; font-weight:bold; }
</style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center p-6">

<h1 class="text-4xl font-bold mb-6">Poker</h1>

<div class="bg-gray-800 p-6 rounded-xl shadow-lg w-full max-w-4xl mb-6">
  <h2 class="text-2xl font-semibold mb-4">Jugadores y apuestas</h2>
  <div id="playersList" class="space-y-4">
    <div class="flex gap-2 items-center">
      <input type="text" placeholder="Nombre" class="p-2 rounded bg-gray-700 playerName">
      <input type="number" placeholder="Apuesta" class="p-2 rounded bg-gray-700 playerBet">
    </div>
  </div>
  <button onclick="addPlayer()" class="bg-blue-600 p-2 rounded hover:bg-blue-700 mt-2">Agregar jugador</button>
  <button onclick="startGame()" class="bg-green-600 p-3 rounded hover:bg-green-700 mt-4 w-full">Iniciar Juego</button>
</div>

<div id="gameContainer" class="w-full max-w-4xl"></div>

<script>
const suits=["♠","♥","♦","♣"];
const values=["2","3","4","5","6","7","8","9","10","J","Q","K","A"];
let deck=[], players=[], currentPlayer=0;

function createDeck(){
  deck=[];
  for(let s of suits){
    for(let v of values) deck.push({value:v,suit:s});
  }
  for(let i=deck.length-1;i>0;i--){
    let j=Math.floor(Math.random()*(i+1));
    [deck[i],deck[j]]=[deck[j],deck[i]];
  }
}

function deckPop(){
  if(deck.length===0) createDeck();
  return deck.pop();
}

function addPlayer(){
  if(document.getElementById("playersList").children.length>=5) return alert("Máximo 5 jugadores");
  const div=document.createElement("div");
  div.className="flex gap-2 items-center";
  div.innerHTML=`<input type="text" placeholder="Nombre" class="p-2 rounded bg-gray-700 playerName">
                 <input type="number" placeholder="Apuesta" class="p-2 rounded bg-gray-700 playerBet">`;
  document.getElementById("playersList").appendChild(div);
}

function startGame(){
  createDeck();
  players=[];
  const names=document.getElementsByClassName("playerName");
  const bets=document.getElementsByClassName("playerBet");
  for(let i=0;i<names.length;i++){
    const name=names[i].value||`Jugador${i+1}`;
    const bet=parseInt(bets[i].value)||100;
    const hand=[deckPop(),deckPop(),deckPop(),deckPop(),deckPop()];
    players.push({name:name, bet:bet, hand:hand, finished:false});
  }
  currentPlayer=0;
  showTurn();
}

function showTurn(){
  const container=document.getElementById("gameContainer");
  let html="";
  players.forEach((p,i)=>{
    html+=`<h2 class="text-xl font-semibold mt-2">${p.name} - Apuesta: $${p.bet}</h2>`;
    html+=`<div class="flex gap-2 mb-2 mt-1">${p.hand.map(c=>`<div class="card">${c.value}${c.suit}</div>`).join("")}</div>`;
    if(i===currentPlayer && !p.finished){
      html+=`<button onclick="stand()" class="bg-red-600 p-2 rounded m-2 hover:bg-red-700">Plantarse</button>`;
    }
  });
  container.innerHTML=html;
}

function stand(){
  players[currentPlayer].finished=true;
  currentPlayer++;
  if(currentPlayer>=players.length){
    showWinners();
  } else {
    showTurn();
  }
}

function handValue(hand){
  // Solo para simplificar: puntaje = suma de valores, A=11, J/Q/K=10
  let score=0;
  hand.forEach(c=>{
    if(c.value==="J"||c.value==="Q"||c.value==="K") score+=10;
    else if(c.value==="A") score+=11;
    else score+=parseInt(c.value);
  });
  return score;
}

function showWinners(){
  let bestScore=-1;
  let winners=[];
  players.forEach(p=>{
    const score=handValue(p.hand);
    if(score>bestScore){bestScore=score; winners=[p.name];}
    else if(score===bestScore) winners.push(p.name);
  });
  const container=document.getElementById("gameContainer");
  let html="";
  players.forEach(p=>{
    html+=`<h2 class="text-xl font-semibold mt-2">${p.name} - Apuesta: $${p.bet}</h2>`;
    html+=`<div class="flex gap-2 mb-2 mt-1">${p.hand.map(c=>`<div class="card">${c.value}${c.suit}</div>`).join("")}</div>`;
  });
  html+=`<h2 class="text-2xl font-bold mt-4 text-green-400">Ganador(es): ${winners.join(", ")}</h2>`;
  container.innerHTML=html;
}
</script>
</body>
</html>
